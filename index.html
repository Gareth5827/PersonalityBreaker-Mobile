<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personality Breaker</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        #timer {
            font-size: 2rem;
            margin-bottom: 20px;
        }
        .button {
            padding: 5px 10px;
            margin: 5px;
            font-size: 0.8rem;
        }
        #buttonContainer {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        #difficultyContainer {
            display: flex;
            justify-content: space-around;
            width: 100%;
            max-width: 400px;
            margin: 10px 0;
        }
        #specialText, #topicText, #bannedWordsLabel, #bannedWords {
            margin: 10px 0;
            text-align: center;
        }
        #specialText {
            width: 90%;
            max-width: 600px;
            height: 250px;
            font-size: 1rem;
            border: 1px solid black;
            padding: 10px;
            overflow-y: scroll;
        }
        #topicText {
            font-size: 1.5rem;
        }
        #bannedWords {
            width: 90%;
            max-width: 600px;
            height: 250px;
            font-size: 1rem;
            border: 1px solid black;
            padding: 10px;
            overflow-y: scroll;
        }
    </style>
</head>
<body>
    <div id="timer">01:30:00</div>
    <div id="buttonContainer">
        <button class="button" id="startButton" onclick="startTimer()">Start Timer</button>
        <button class="button" id="stopButton" onclick="stopTimer()">Stop Timer</button>
        <button class="button" id="resetButton" onclick="resetTimer()">Reset Timer</button>
    </div>
    <div id="difficultyContainer">
        <button class="button" id="easyToggle" onclick="setDifficulty('easy')">Easy</button>
        <button class="button" id="mediumToggle" onclick="setDifficulty('medium')">Medium</button>
        <button class="button" id="hardToggle" onclick="setDifficulty('hard')">Hard</button>
    </div>
    <button class="button" id="newTopicButton" onclick="newTopic()">New Topic</button>
    <div id="specialText"></div>
    <div id="topicText"></div>
    <div id="bannedWordsLabel">Banned words</div>
    <div id="bannedWords"></div>

    <button class="button" id="startRecording">Start Recording</button>
    <button class="button" id="stopRecording" disabled>Stop Recording</button>
    <audio id="audioPlayback" controls></audio>

    <script>
        let timerInterval;
        let timeElapsed = 0;
        let previousTopic = '';
        const topics = ["the weather", "shopping malls", "paint", "cardboard boxes", "concerts", "a ceiling fan"];
        const words = ["apple", "banana", "grape", "pineapple", "lime", "lemon", "orange", "tangerine", "cherry", "crab apple", "plantain", "grapefruit", "clementine", "pomegranate", "passionfruit"];
        const stationsWithSongs = {
        "CJIQ 88.3, the tri-cities alternative": [
            "Human heat by Sam Robers",
            "The mountain by Three days grace",
            "Day I die by The national",
            "One thing by Finger Eleven",
            "I feel alive by Art D'ecco",
            "The best by Awolnation",
            "Can't slow down by Almost monday"
        ],
        "Chym 96.7, Kitcheners perfect music mix": [
            "Shivers by Ed Sheeran",
            "Waterfalls by TLC",
            "Cheap thrills by Sia",
            "Powerless by Nelly Furtado",
            "Take on me by A-ha",
            "These days by MacKenzie Porter",
            "Roar by Katy Perry",
            "Beautiful things by Benson Boone"
        ],
        "Country 106.7, #1 for country": [
            "But I got a beer in my hand by Like Bryan",
            "All night by Brothers Osborne",
            "Band on her t-shirt by The washboard union",
            "Stars like confetti by Dustin lynch",
            "What is a good memory by Tyler joe miller",
            "Toes by Zac brown band",
            "Broken umbrella by Jojo manson",
            "Pour me a drink by Post malone and Blake shelton"
        ]
            };
        let difficulty = 'easy';

        function startTimer() {
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeElapsed += 10;
                updateTimerDisplay();
            }, 10);
        }
        
        function stopTimer() {
            clearInterval(timerInterval);
        }
        
        function resetTimer() {
            clearInterval(timerInterval);
            timeElapsed = 0; // Reset to 0:00
            updateTimerDisplay();
        }
        
        function updateTimerDisplay() {
            const minutes = String(Math.floor(timeElapsed / 60000)).padStart(2, '0');
            const seconds = String(Math.floor((timeElapsed % 60000) / 1000)).padStart(2, '0');
            const milliseconds = String((timeElapsed % 1000) / 10).padStart(2, '0');
            document.getElementById('timer').innerText = `${minutes}:${seconds}:${milliseconds}`;
        }

        function newTopic() {
            let newTopic;
            const showTypes = ["morning show", "noon show", "evening show"];
            const times = ["start", "middle", "end"];
            const months = ["April", "May", "June", "July", "August", "September", "October", "November", "December", "January", "February", "March"];
        
            do {
                newTopic = topics[Math.floor(Math.random() * topics.length)];
            } while (newTopic === previousTopic);
        
            const showType = showTypes[Math.floor(Math.random() * showTypes.length)];
            const time = times[Math.floor(Math.random() * times.length)];
            const month = months[Math.floor(Math.random() * months.length)];
        
            previousTopic = newTopic;
            document.getElementById('topicText').innerText = `Your topic is ${newTopic}! And it's a ${showType} at the ${time} of ${month}`;
            updateBannedWords();
            updateSpecialText();
        }

        function setDifficulty(level) {
            difficulty = level;
            document.getElementById('easyToggle').style.backgroundColor = level === 'easy' ? 'lightblue' : '';
            document.getElementById('mediumToggle').style.backgroundColor = level === 'medium' ? 'lightblue' : '';
            document.getElementById('hardToggle').style.backgroundColor = level === 'hard' ? 'lightblue' : '';
            updateBannedWords(); // Update banned words immediately when difficulty changes
        }

        function updateBannedWords() {
            let numWords;
            if (difficulty === 'easy') {
                numWords = Math.floor(Math.random() * 3) + 1;
            } else if (difficulty === 'medium') {
                numWords = Math.floor(Math.random() * 4) + 4;
            } else {
                numWords = Math.floor(Math.random() * 8) + 8;
            }
            const banned = [];
            while (banned.length < numWords) {
                const word = words[Math.floor(Math.random() * words.length)];
                if (!banned.includes(word)) {
                    banned.push(word);
                }
            }
            document.getElementById('bannedWords').innerText = banned.join(', ');
        }

        function updateSpecialText() {
            const station = Object.keys(stationsWithSongs)[Math.floor(Math.random() * Object.keys(stationsWithSongs).length)];
            const songs = stationsWithSongs[station];
            const song1 = songs[Math.floor(Math.random() * songs.length)];
            let song2;
            do {
                song2 = songs[Math.floor(Math.random() * songs.length)];
            } while (song2 === song1);
            document.getElementById('specialText').innerText = `That was ${song1} on ${station}. And coming up next we've got ${song2} only on ${station}!`;
        }

        // Set default difficulty to easy and generate the initial topic
        setDifficulty('easy');
        newTopic();

        updateTimerDisplay(); // Initial display update

        // Audio recording functionality
        let mediaRecorder;
        let audioChunks = [];

        document.getElementById('startRecording').addEventListener('click', async () => {
            const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
            mediaRecorder = new MediaRecorder(stream);
            mediaRecorder.start();

            mediaRecorder.addEventListener('dataavailable', event => {
                audioChunks.push(event.data);
            });

            mediaRecorder.addEventListener('stop', () => {
                const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
                const audioUrl = URL.createObjectURL(audioBlob);
                const audio = document.getElementById('audioPlayback');
                audio.src = audioUrl;
                audioChunks = [];
            });

            document.getElementById('startRecording').disabled = true;
            document.getElementById('stopRecording').disabled = false;
        });

        document.getElementById('stopRecording').addEventListener('click', () => {
            mediaRecorder.stop();
            document.getElementById('startRecording').disabled = false;
            document.getElementById('stopRecording').disabled = true;
        });
    </script>
</body>
</html>
